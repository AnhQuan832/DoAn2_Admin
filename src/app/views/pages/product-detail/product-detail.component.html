<form class="container ps-4 pb-4" [formGroup]="addProductForm">
  <div class="d-flex flex-row gap-4">
    <div class="d-flex flex-column w-50 me-4">
      <p-divider align="left">
        <div class="inline-flex align-items-center">
          <b>General</b>
        </div>
      </p-divider>
      <span class="p-float-label col-11">
        <h6 class="addressLabel ps-0">Name</h6>
        <input class="inputtext ps-1 w-100" type="text" formControlName="name" />
      </span>
      <span class="p-float-label">
        <h6 class="addressLabel ps-0">Brand</h6>
        <div class="d-flex gap-2">
          <div class="col-11">
            <p-dropdown [options]="brandOption" optionLabel="name" [autoDisplayFirst]="false" formControlName="brand">
            </p-dropdown>
          </div>
          <div class="col-1 d-flex align-items-center">
            <i class="bi bi-plus-circle-dotted" (click)="onAddBrand()" pTooltip="Add new Brand"></i>
          </div>
        </div>
      </span>
      <span class="p-float-label">
        <h6 class="addressLabel ps-0">Category</h6>
        <div class="d-flex gap-2">
          <div class="col-11">
            <p-dropdown [options]="categoryOption" optionLabel="name" [autoDisplayFirst]="false"
              formControlName="category">
            </p-dropdown>
          </div>
          <div class="col-1 d-flex align-items-center">
            <i class="bi bi-plus-circle-dotted" (click)="onAddCategory()" pTooltip="Add new Category"></i>
          </div>
        </div>
      </span>
      <span class="p-float-label">
        <h6 class="addressLabel ps-0">Sub category</h6>
        <div class="d-flex gap-2">
          <div class="col-11">
            <p-dropdown [options]="subCategoryOption" optionLabel="name" [autoDisplayFirst]="false"
              formControlName="subCategory">
            </p-dropdown>
          </div>
          <div class="col-1 d-flex align-items-center">
            <i class="bi bi-plus-circle-dotted" (click)="onAddSubCategory()" pTooltip="Add new Sub Category"></i>
          </div>
        </div>
      </span>
      <span class="p-float-label col-11">
        <h6 class="addressLabel ps-0">Price</h6>
        <input class="inputtext ps-1 w-100" type="text" formControlName="price" />
      </span>

      <span class="p-float-label col-11">
        <h6 class="addressLabel ps-0">Detail</h6>
        <textarea formControlName="detail" class="w-100" name="" id="textarea" pInputTextarea
          [autoResize]="true"></textarea>
      </span>

      <span class="p-float-label col-11">
        <h6 class="addressLabel ps-0">Description</h6>
        <textarea formControlName="description" class="w-100" name="" id="textarea" pInputTextarea
          [autoResize]="true"></textarea>
      </span>
    </div>
    <div class="w-50 ms-4">
      <p-divider align="left">
        <div class="inline-flex align-items-center">
          <b>Attribute</b>
        </div>
      </p-divider>
      <!-- <div class="size attribute" *ngIf="listSize.length > 0">
        <h6 class="mt-2"><b>Size</b></h6>
        <div
          class="size"
          *ngFor="let size of listSize"
          [id]="size.attributeId"
          (click)="onAttribute($event, size, 'size')"
        >
          {{ size.name }}
        </div>
      </div>
      <div class="color attribute" *ngIf="listColor.length > 0">
        <h6 class="mt-2"><b>Color</b></h6>
        <div
          class="color"
          *ngFor="let color of listColor"
          [id]="color.attributeId"
          (click)="onAttribute($event, color, 'color')"
        >
          {{ color.name }}
        </div>
      </div>
      <span class="p-float-label col-11">
        <h6 class="addressLabel ps-0">Price</h6>
        <input
          class="inputtext ps-1 w-50"
          type="text"
          [(ngModel)]="attPrice"
          [ngModelOptions]="{ standalone: true }"
        />
      </span> -->

      <p-table [value]="product.varieties" dataKey="id" [tableStyle]="{ 'min-width': '20rem' }">
        <ng-template pTemplate="header">
          <tr>
            <th *ngIf="listSize.length > 0">Size</th>
            <th *ngIf="listColor.length > 0">Color</th>
            <th>Stock</th>
            <th>Price</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-variety let-editing="editing">
          <tr>
            <td *ngIf="listSize.length > 0">
              {{variety.varietyAttributes[0]?.type == 'SIZE' ? variety.varietyAttributes[0]?.name:
              variety.varietyAttributes[1]?.name}}
            </td>
            <td *ngIf="listColor.length > 0">
              {{variety.varietyAttributes[0]?.type != 'SIZE' ? variety.varietyAttributes[0]?.name:
              variety.varietyAttributes[1]?.name}}
            </td>
            <td></td>
            <td [pEditableColumn]="variety.name" pEditableColumnField="price">
              <p-cellEditor>
                <ng-template pTemplate="input">
                  <input pInputText type="number" [(ngModel)]="variety.price" [ngModelOptions]="{standalone: true}"
                    required />
                </ng-template>
                <ng-template pTemplate="output">
                  {{ variety.price | currency : 'VND' }}
                </ng-template>
              </p-cellEditor>
            </td>
          </tr>
        </ng-template>
      </p-table>

      <span *ngIf="!isAddAtt">
        <div class="add-attribute d-flex" (click)="onShowAttribute()">
          <i class="bi bi-plus"></i>
          <p class="my-auto">Add more attribute</p>
        </div>
      </span>
      <span *ngIf="isAddAtt" class="p-float-label col-11">
        <h6 class="addressLabel ps-0">Color</h6>
        <div class="d-flex gap-2">
          <div class="col-11">
            <p-dropdown [options]="attribute.COLOR" optionLabel="name" [autoDisplayFirst]="false"
              formControlName="color">
            </p-dropdown>
          </div>
          <div *ngIf="addProductForm.get('color').value" class="col-1 d-flex align-items-center">
            <i style="color: green" class="bi bi-check-circle" (click)="onAddAttribute('color')" pTooltip="Confirm"></i>
          </div>
        </div>
      </span>

      <span *ngIf="isAddAtt" class="p-float-label col-11">
        <h6 class="addressLabel ps-0">Size</h6>
        <div class="d-flex gap-2">
          <div class="col-11">
            <p-dropdown [options]="attribute.SIZE" optionLabel="name" [autoDisplayFirst]="false" formControlName="size">
            </p-dropdown>
          </div>
          <div *ngIf="addProductForm.get('size').value" class="col-1 d-flex align-items-center">
            <i style="color: green" class="bi bi-check-circle" (click)="onAddAttribute('size')" pTooltip="Confirm"></i>
          </div>
        </div>
      </span>
    </div>
  </div>
  <div class="pet-image col-11">
    <p-divider align="left">
      <div class="inline-flex align-items-center">
        <b>Product Image</b>
      </div>
    </p-divider>
    <div class="img-container d-flex gap-4 m-4 my-1" *ngIf="listImages">
      <div class="img-content" *ngFor="let img of listImages">
        <div class="btn-delete rounded-circle d-flex justify-content-center align-items-center"
          (click)="deleteImg(img)">
          <i class="bi bi-x" style="color: #f5f5f5"></i>
        </div>
        <img src="{{ img }}" alt="" />
      </div>
    </div>
    <div class="d-flex justify-content-center w-100">
      <p-fileUpload name="file[]" class="w-100 my-1" name="demo[]" chooseLabel="Select image" cancelLabel="Cancel"
        [showUploadButton]="false" [multiple]="true" [maxFileSize]="10000000" (onSelect)="onSelectFiles($event)"
        (onRemove)="onRemoveFile($event)">
        <ng-template pTemplate="content">
          <!-- <ul *ngIf="uploadedFiles.length">
            <li *ngFor="let file of uploadedFiles">
              {{ file.name }} - {{ file.size }} bytes
            </li>
          </ul> -->
        </ng-template>
      </p-fileUpload>
    </div>
  </div>
  <div class="button-group d-flex justify-content-center mt-2">
    <button type="submit" class="btn btn-primary text-nowrap" (click)="onSaveProduct()"
      [disabled]="addProductForm.invalid">
      Save
    </button>
  </div>
</form>
<p-toast key="toast"></p-toast>